<p><a href="https://github.com/ryanlayer/samplot">Source code</a></p>

<p>We have made two major updates to Samplot</p>
<h2 id="1-split-view">1. Split view</h2>

<p>The original version of samplot visualized one continuous genomic region, which
made viewing translocations impossible and large SVs difficult and
time-consuming. By providing support for two areas, we can now plot the two
ends of a translocation and zoom into the breakpoints of large SVs.</p>

<p>Here is the chromosome 2/X inverted translocation that we identified in a
patient with early infantile epileptic encephalopathy (EIEE) [BE Ostrander et
al., Genomic Medicine 2018]. Notice the break in the middle that is indicated
by an ellipsis in the SV plot on top and whitespace in the sample plot. Split
view support has also been extended to annotation and transcript plots, as seen
below.</p>

<center><img src="/assets/2019-06-04-Samplot-improvement/translocation.png" height="300px" /></center>

<p>This plot is generated by providing 2 sets of chromosomal positions and using
the <code class="language-plaintext highlighter-rouge">--zoom</code> parameter to specify the size of the flanking regions.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python samplot.py \
    -c 2 -s 59405943 -e 59405943 \
    -c X -s 151118533 -e 151118533 \
    -b samplot/test/data/2_59305747-59505747_X_151018513-151218513.BND.bam
    -o translocation.png \
    -t BND \
    --zoom 10000
</code></pre></div></div>

<p>Here are the original and zoomed plots for a 45Kb deletion in HG002 sample from
the GIAB Ashkenazim Trio. The full plot took four seconds to complete and the
zoom took one second.</p>

<center><img src="/assets/2019-06-04-Samplot-improvement/big.png" height="300px" /></center>
<center><img src="/assets/2019-06-04-Samplot-improvement/big_zoom.png" height="300px" /></center>

<p>Generating a zoomed plot is straightforward, add the <code class="language-plaintext highlighter-rouge">--zoom</code> parameter:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python samplot.py \
    -c 1 -s 72766323 -e 72811839 \
    -b HG002.hs37d5.2x250.bam \
    -o big_zoom.png \
    -t DEL \
    -d 10 \
    --zoom 1000
</code></pre></div></div>
<h2 id="2-sv-vcf-browser">2. SV VCF browser</h2>

<p>Given a VCF with SVs and the sample BAMs, run <code class="language-plaintext highlighter-rouge">samplot_vcf.py</code> to generate the
variants plots and a web page that provides an interface to browse the plots.
For example, the SVs in <code class="language-plaintext highlighter-rouge">samplot/test/data/test.vcf</code> produce the following
site.  Basic information about the SVs is given in each row, and an SV plot can
be displayed below by clicking on the row.</p>

<p>We have many improvemtns planned for this interface, so stay tuned.</p>

<center>
<iframe width="700" height="1000" src="/assets/2019-06-04-Samplot-improvement/test_suite/index.html" frameborder="0"></iframe>
</center>

<p>The command to produce this site is:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    python ../../src/samplot_vcf.py \
        -d output_dir \
        --vcf test.vcf \
        --sample_ids HG002 HG003 HG004 \
        -b ../data/HG002_Illumina.bam \
        ../data/HG003_Illumina.bam \
        ../data/HG004_Illumina.bam \
        --command_file samplot_commands.sh
</code></pre></div></div>
<p>This command will create the directory <code class="language-plaintext highlighter-rouge">output_dir</code>, <code class="language-plaintext highlighter-rouge">output_dir/index.html</code>,
and <code class="language-plaintext highlighter-rouge">samplot_commands.sh</code> which contains the commands needed to generate the
samplot images. Run <code class="language-plaintext highlighter-rouge">bash samplot_commands.sh</code> and the plots will be placed
into <code class="language-plaintext highlighter-rouge">output_dir</code>, and begin browsing.</p>

<p>See the <a href="https://github.com/ryanlayer/samplot">samplot page</a>
for the full documentation.</p>
