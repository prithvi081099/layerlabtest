<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Samplot: Rapid SV Visualization | Layer Lab</title>
<meta name="generator" content="Jekyll v3.6.3" />
<meta property="og:title" content="Samplot: Rapid SV Visualization" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Source code" />
<meta property="og:description" content="Source code" />
<link rel="canonical" href="/2018/04/19/Samplot-Rapid-SV-Visualization.html" />
<meta property="og:url" content="/2018/04/19/Samplot-Rapid-SV-Visualization.html" />
<meta property="og:site_name" content="Layer Lab" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-04-19T00:00:00-06:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Samplot: Rapid SV Visualization","dateModified":"2018-04-19T00:00:00-06:00","datePublished":"2018-04-19T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"/2018/04/19/Samplot-Rapid-SV-Visualization.html"},"description":"Source code","url":"/2018/04/19/Samplot-Rapid-SV-Visualization.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Layer Lab" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56403324-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper">
    
    
    <a class="site-title" rel="author" href="/">Layer Lab</a>

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/about/">About</a>
            
          
            
            
          
            
            
            <a class="page-link" href="/join_us/">Join Us</a>
            
          
            
            
            <a class="page-link" href="/people/">People</a>
            
          
            
            
            <a class="page-link" href="/Publications/">Publications</a>
            
          
            
            
            <a class="page-link" href="/software/">Software</a>
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Samplot: Rapid SV Visualization</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-04-19T00:00:00-06:00" itemprop="datePublished">Apr 19, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="https://github.com/ryanlayer/samplot">Source code</a></p>

<p>Visualization is an integral part of SV discovery and validation, and many
methods have been developed to help make this less painful.</p>
<ul>
  <li><a href="https://www.ncbi.nlm.nih.gov/pubmed/22517427">IGV</a></li>
  <li><a href="https://www.ncbi.nlm.nih.gov/pubmed/20562449">SAVANT</a></li>
  <li><a href="https://www.ncbi.nlm.nih.gov/pubmed/28334120">SVPV</a></li>
  <li><a href="https://www.ncbi.nlm.nih.gov/pubmed/20975128">Gremlin</a></li>
  <li><a href="http://svviz.github.io/svviz/">svviz</a></li>
</ul>

<p>Personally, I use IGV because it allows me to dig into individual SVs. You can
load multiple samples and multiple annotation tracks, inspect single reads, and
zoom in/out and look up/downstream of the event.  These features can 
help us to understand why a particular call was made/missed.  Unfortunately
IGV, and really any piece of software, has some functionality gaps. IGV
requires a lot of clicking, menu selecting, zooming in and out, and scanning.
Consider the case given below where I want to look at a particular SV in three
samples.</p>

<iframe width="569" height="320" src="https://www.youtube.com/embed/OFED630RAns" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe>

<p>It is a little bit of a pain.</p>

<p>This gets even worse if I want to look at MANY SVs. That is a lot more
clicking, re-sorting, and scanning. To make matters worse, what if the BAMs are
not on my local machine or even a local server? Whate if the BAMs are in the
cloud or on a collaborator’s cluster where <code class="highlighter-rouge">ssh -X</code> is just not going to cut it.</p>

<p>To address this case we developed samplot. A command line tool that takes SV
coordinates and bam files and produces high-quality images that highlight
any alignment and depth signals that substantiate the SV. Here is that same SV
for the same samples from samplot.</p>

<p><img src="/assets/samplot_samples.jpg" alt="samplot" /></p>

<p>To get this image you need to:
Get the code:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/ryanlayer/samplot.git
</code></pre></div></div>
<p>Get the annotations:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget ftp://ftp.ensembl.org/pub/grch37/release-84/gff3/homo_sapiens/Homo_sapiens.GRCh37.82.gff3.gz
bedtools sort -i Homo_sapiens.GRCh37.82.gff3.gz \
| bgzip -c &gt; Homo_sapiens.GRCh37.82.sort.gff3.gz
tabix Homo_sapiens.GRCh37.82.sort.gff3.gz

wget http://hgdownload.cse.ucsc.edu/goldenpath/hg19/encodeDCC/wgEncodeMapability/wgEncodeDukeMapabilityUniqueness35bp.bigWig
bigWigToBedGraph wgEncodeDukeMapabilityUniqueness35bp.bigWig wgEncodeDukeMapabilityUniqueness35bp.bed
bgzip wgEncodeDukeMapabilityUniqueness35bp.bed
tabix wgEncodeDukeMapabilityUniqueness35bp.bed.gz

curl http://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/simpleRepeat.txt.gz \
| bgzip -d -c \
| cut -f2,3,4 \
| bedtools sort -i stdin \
| bgzip -c \
&gt; simpleRepeat.bed.gz
tabix simpleRepeat.bed.gz

curl http://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/rmsk.txt.gz \
| bgzip -d -c \
| cut -f 6,7,8,13 \
| bedtools sort -i stdin \
| bgzip -c &gt; rmsk.bed.gz
</code></pre></div></div>

<p>Make the image:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>samplot/src/samplot.py \
    -c chr4 \
    -s 115928730 \
    -e 115931875 \
    -b samplot/test/data/NA12878_restricted.bam,samplot/test/data/NA12889_restricted.bam,samplot/test/data/NA12890_restricted.bam \
    -o samples.jgp \
    -t DEL \
    -d 10 \
    -T Homo_sapiens.GRCh37.82.sort.gff3.gz \
    -A rmsk.bed.gz,wgEncodeDukeMapabilityUniqueness35bp.bed.gz
</code></pre></div></div>

<p>Each sample gives the per-base coverage (filled grey area) scaled on the right
y-axis and the alignments scaled by insert size (distance between pair ends) on
the left y-axis. Paired-end alignments are boxes connected by solid lines.
Split-read alignments are circles connected by dashed lines.  The color of the
alignments correspond to the type of SV they appear to support.</p>

<p>Since most BAMs are mostly normal reads, we can reduce runtime and plot
messiness by giving users the option to display only a small sample of the
concordant reads (+/- orientation and a normal insert size). Here we see just
10 “normal reads.”</p>

<p>Under the samples are a variable number of annotations (bgziped, tabixed BED
files) whose behavior is driven by the 4th column of the file. If it is
empty, then the intervals are displayed as black bars. If the 4th column is a
float, then that float drives the grayscale color of the bar where one is dark
zero is white (e.g., wgEncodeDukeMapabilityUniqueness35bp.bed.gz. If the 4th
column is present but is not a float, it is treated as a name and displayed
above the interval (e.g., rmsk.bed.gz annotation). Last is a transcript file
that gives genes and exons. This region spans an intronic region of the
NDST4 gene.</p>

<p>While static images lack some of the functionality that interactive browsers
provide, there are quite a few upsides. If the BAMs are remote, then run
samplot on the remote server and download the image files. If you have many
SVs, you can fire off many samplot runs (in parallel with something like 
<a href="https://github.com/brentp/gargs">gargs</a>). If you are overwhelmed by going
through all of those images, or if you have a team that wants to collaborate on
reviewing the SVS, then check out SV-plaudit ( 
<a href="https://github.com/jbelyeu/SV-plaudit">source code</a>,
<a href="https://www.youtube.com/edit?o=U&amp;video_id=phD-GdkOwiY">setup video</a>,
<a href="https://www.biorxiv.org/content/early/2018/02/14/265058">preprint</a> )</p>

  </div> 
  <div id="disqus_thread"></div>
  <script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
  /*
     var disqus_config = function () {
     this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
     this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
     };
     */
  (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://layerlab.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  
  
  

  <a class="u-url" href="/2018/04/19/Samplot-Rapid-SV-Visualization.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Layer Lab</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Layer Lab</li><li><a class="u-email" href="mailto:web@layerlab.org">web@layerlab.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ryanlayer"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ryanlayer</span></a></li><li><a href="https://www.twitter.com/ryanlayer"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">ryanlayer</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Developing algorithms for large-scale genomics at CU Boulder Computer Science and Biofrontiers Institute. Make science faster.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
